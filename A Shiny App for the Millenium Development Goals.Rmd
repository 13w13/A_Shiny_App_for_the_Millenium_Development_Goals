---
title: "A Shiny App for the Millenium Development Goals"
runtime: shiny
author: "Julieva Cohen, Alexandra, Antoine Settelen, Simon Weiss"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Navigation {.tabset .tabset-fade .tabset-pills}
## 1. Introduction

### 1.1 Aim of the Group Project from U3-Programming-Advanced R-Msc AI and BA - TBS
- The aim of the project is to make an interactive graphical presentation of data using Shiny App.
- The user should be able to select parameters themselves. The data must be non-trivial, requiring the use of data from several sources or from several different tables.
- Work in groups. circa Three students per group. You can self-select groups.
- There should be need for computations on the data to achive the final results.


### 1.2 Presentaiton of the project choosen and Data
The goal of our project is to build a shiny App to monitor Millennium Developement Goals Progress over time. 

In the year 2000, the member states of the United Nations agreed to a set of goals to measure the progress of global development. The aim of these goals was to increase standards of living around the world by emphasizing human capital, infrastructure, and human rights.     

The eight goals are:

    To eradicate extreme poverty and hunger
    To achieve universal primary education
    To promote gender equality and empower women
    To reduce child mortality
    To improve maternal health
    To combat HIV/AIDS, malaria, and other diseases
    To ensure environmental sustainability
    To develop a global partnership for development


Data on Millennium Development Goals (MDG) indicator trends for developing countries and for different groups of countries are curated in the World Development Indicators database. Each year the World Bank uses these data to assess the progress made towards the MDGs.    

In order to have an aggreted data, we have used a very rich database provided by **Driven Data** offering an open challenge until 2021 with data compiled from the http://www.worldbank.org/ website. The description below of the MDG below comes from their plateforme. 

Driven Data aggregated  data from 1972-2007 on over 1200 macroeconomic indicators in 214 countries around the world. A random snapshot of the data looks like the below. Each row represents a timeseries for a specific indicator and country. The row has an id, a country name, a series code, a series name, and data for the years 1972 - 2007.

![Snashot of data]("C:/Users/swp/Documents/_Perso/Cours/M2/U3. Programing/Advanced R/0.Group Project/Shiny Project/shiny_app/img/snapshot_millenium.png")

We hope that this presentation allowed to understand our project and the real usefulness of a shiny app! 
Indeed, building interactive dashboards offers the possibility to explore the evolution trend for each country and/or region of the world, to compare them both for each macroeconomic indicator but also for each millennium goal.

### 1.3 Examples found of target data visualization for our project
http://datatopics.worldbank.org/mdgs/trends-and-projections-of-each-mdg-indicator-for-each-country.html
http://datatopics.worldbank.org/sdgs/




### 1.4 Outilne used for data preparation 

Deal with Missing Values 
Rename column : OK
Casting from a wide table to a long table : OK

transformation into Time Series : Needed ? 

Add region ? 


### 1.5 Outilne used for our app dev 

#Example of outine from the prof

    Create two Plots: one with death per capita, one with death in absolute numbers. Hint: From coronaD, create a new data table with death per capita instead of death.

    In the original data table coronaD, downloaded from GitHub, add one row with EU27 (the countries in the table that is also a country in the European Union)

    For extra credits: Add annotations to your plot, e.g. the start of the national lock-downs.
    Collect user input:
        Let the user decide between logarithmic and linear scale on the y-axis
        Let the user decide which countries to highlight
        Let the user decide which time frame
    Use a nice theme for the plots, preferably construct the theme yourself with + theme()

    For extra credits: Use a nice theme and layout for the website




## 2. Starting the project

### 2.0 Loading library  
```{r}
library(shiny)
library(magrittr)
library(data.table)
library(ggplot2)
library(readr)

```

### 2.1 Loading the Data  

```{r}
urlfile="https://drive.google.com/uc?export=download&id=1mbWQtW83faGtfnwnjlopJblGavaCm7_T"
```

We have registerred into the plateform to acces to the databse and updated the csv file in google Drive

```{r}
goalD<-urlfile%>% url %>% read_csv %>% as.data.table 
```


```{r}
goalD %>% head()
str(goalD)
```


```{r}
goalD[X1==559]
```
So here we can see that ID=559 corresponds to Afganistant 7.8 indicators for environetanl sustainibilty goal (Goal7) According to MG website, 7.8 is defined by the Proportion of population using an improved drinking water source. 

```{r}
as.character(c(1972:2007))
```


Using colnames() in order to extract all the column names that are Dates and save these as the character vector Dates. 
Dates are from the 2dn column to the 37th
But first, we should rename these columns by removing "YR+Date" and add a _ in the other columns

```{r}
cols<-c("Index","1972","1973","1974","1975","1976","1977","1978","1979","1980","1981","1982","1983","1984","1985","1986","1987","1988","1989","1990","1991","1992","1993","1994","1995","1996","1997","1998","1999","2000","2001","2002","2003","2004","2005","2006","2007","Country_Name","Series_Code","Series_Name")
colnames(goalD)<-cols
head(goalD)
```


```{r}
Dates = (colnames(goalD[,!(c(1,38,39,40))]))
```
We should rename these column by removing the "YR+Date"


```{r}
PlotDT = data.table::melt(goalD, id.vars = c(1,38,39,40), 
          measure.vars = Dates, 
          variable.name = "Date",
          value.name = "Value")
```



Change the data type of the Date column to "Date" using the function as.Date()
```{r}

PlotDT$Date = PlotDT$Date %>%  as.Date(format = "%Y")
head(PlotDT$Date)
```
as.date needs day and month. here create fake days and month : valid solution ? 
```{r}

D$year <- format(as.Date(D$date), format = "%Y") 

library(lubridate)
year(df1$Date)
```


Select a subset of PlotDT with Province/State as and Country/Region France.
```{r}
ggplot(PlotDT[`Country_Name`=="China" & `Series_Name`=="Ensure environmental sustainability"],
       aes(x= Date, y = Value)) + 
   geom_line()

```

```{r}
PlotDT[`Country_Name`=="China" & `Series_Name`=="Ensure environmental sustainability"]
```





This R Markdown document is made interactive using Shiny. Unlike the more traditional workflow of creating static reports, you can now create documents that allow your readers to change the assumptions underlying your analysis and see the results immediately. 

To learn more, see [Interactive Documents](http://rmarkdown.rstudio.com/authoring_shiny.html).

```

## Embedded Application

It's also possible to embed an entire Shiny application within an R Markdown document using the `shinyAppDir` function. This example embeds a Shiny application located in another directory:

```{r tabsets, echo=FALSE}
shinyAppDir("C:/Users/swp/Documents/_Perso/Cours/M2/U3. Programing/Advanced R/Day 3-20200926/shinyapp/MyFirstApp/",
  options = list(
    width = "100%", height = 550
  )
)
```

Note the use of the `height` parameter to determine how much vertical space the embedded application should occupy.

You can also use the `shinyApp` function to define an application inline rather then in an external directory.

In all of R code chunks above the `echo = FALSE` attribute is used. This is to prevent the R code within the chunk from rendering in the document alongside the Shiny components.



